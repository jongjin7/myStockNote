# 주식 노트 개발 및 운영 프로세스 가이드 (Workflow & Process Guide)

이 문서는 [PRD (MVP v2.0)](./prd.md)를 기반으로, 실제 사용자의 데이터를 어떻게 입력받을 것인지(입력 프로세스)와 개발을 어떻게 진행할 것인지(개발 워크플로우)를 상세히 정의한다.

---

## 1. 데이터 입력 프로세스 정의 (Input Process)

사용자의 수동 입력 편의성을 극대화하여 '기록하는 즐거움'을 주는 것을 목표로 한다.

### 1.1 계좌 및 자산 갱신 프로세스
1. **갱신 주기**: 주 1회 또는 매매 직후 권장.
2. **입력 경로**: 대시보드 요약 카드 또는 [계좌 관리] 메뉴.
3. **핵심 UI**: 
   - 현재 예수금(Cash Balance)을 즉시 수정할 수 있는 인라인 에디팅 기능.
   - 마지막 업데이트 시각을 자동으로 기록하여 '자산 상태의 신선도'를 시각화.

### 1.2 종목 등록 프로세스

#### 1.2.1 보유 종목 (Holdings) 등록
1. **시작**: [종목 추가] 버튼 클릭 -> '보유 종목' 선택.
2. **정보 입력**: 종목명, 종목코드(선택), 수량, 단가, 계좌 선택.
3. **저장 후 연계**: "종목이 추가되었습니다. 매수 이유를 기록해볼까요?" Contextual Prompt 제공.

#### 1.2.2 관심 종목 (Watchlist) 등록
1. **시작**: [종목 추가] 버튼 클릭 -> '관심 종목' 선택.
2. **정보 입력**: 종목명, 종목코드(선택). (수량/단가/계좌 불필요)
3. **저장 후 연계**: "관심 종목이 등록되었습니다. 리서치 자료를 남겨보세요." Contextual Prompt 제공.

### 1.3 투자 판단 및 리서치 아카이빙 (핵심)
1. **AI 분석 복사/붙여넣기**:
   - ChatGPT 등에서 얻은 텍스트를 `buyReason` 또는 `currentThought` 필드에 붙여넣으면 형식이 유지되도록 보존.
2. **이미지/뉴스 캡처 첨부**:
   - 드래그 앤 드롭으로 리포트, 차트 캡처본 업로드.
   - 시스템은 백그라운드에서 WebP 전환 및 800px~1200px 수준으로 리사이징하여 용량 최적화.

### 1.4 매매 및 사후 회고 프로세스
1. **매매 발생 시**: 사용자가 수량/단가 정보를 업데이트.
2. **회고 트리거**: 상태가 `SOLD`(전량 매도)로 변경되는 시점에 **'매도 복기 노트'** 작성 유도.
3. **회고 내용**: "당초 시나리오와 맞았는가?", "어떤 감정이 의사결정에 영향을 주었는가?" 등의 가이드 제공.

---

## 2. 개발 워크플로우 (Development Workflow)

AI 에이전트와 인간 개발자가 협업하여 고품질의 결과물을 신속하게 도출하기 위한 표준 절차이다.

### 2.1 개발 사이클 (Iterative Development)
1. **Feature Definition**: 구현할 기능의 PRD 요구사항과 데이터 모델(types)을 먼저 검토.
2. **Implementation**: 
   - **Styling**: Tailwind 4 기반 프리미엄 디자인 적용 (Glassmorphism, Vibrant Colors).
   - **Logic**: TypeScript의 엄격한 타입 체크(`VerbatimModuleSyntax`) 준수.
3. **Local Testing**: `pnpm dev`를 통해 코드 변경사항 실시간 반영 확인.
4. **Agent Verification**: `browser_subagent`를 사용하여 렌더링 검증, 콘솔 에러 체크, 스크린샷 캡처 수행.

### 2.2 코드 가이드라인
- **Components**: 재사용 가능한 원자(Atomic) 단위 컴포넌트 개발.
- **State Management**: React Context(`AppContext`)를 사용하여 LocalStorage 기반의 데이터 일관성 유지.
- **Error Handling**: LocalStorage 용량 초과(`QuotaExceededError`) 시에 대한 예외 처리 필수.

### 2.3 UI/UX 원칙
- **Aesthetics**: 단순한 MVP를 넘어 'Premium Look & Feel'을 지향.
- **Interactivity**: 버튼 호버, 페이지 전환 시 부드러운 애니메이션(`framer-motion` 또는 CSS transitions) 적용.

---

## 3. 개발 환경 목 데이터 시스템 사용 가이드

### 3.1 목적

다양한 시나리오(큰 수익, 손실, 소액/대규모 포트폴리오 등)를 빠르게 테스트하고 UI 반응성을 검증하기 위해 MSW 기반 목 데이터 시스템을 활용한다.

### 3.2 자동 초기화

개발 서버(`pnpm dev`) 시작 시:
1. MSW 워커가 자동으로 시작됨
2. localStorage가 비어있으면 기본 목 데이터 자동 생성
3. 브라우저 콘솔에 사용 가능한 명령어 출력

### 3.3 시나리오 테스트 워크플로우

#### 단계 1: 기본 데이터 확인
```javascript
// 브라우저 콘솔에서 실행
mockUtils.getCurrentData()  // 현재 로드된 데이터 확인
```

#### 단계 2: 시나리오 변경
```javascript
// 큰 수익 케이스 테스트
mockUtils.loadScenario('bigProfit')

// 손실 케이스 테스트
mockUtils.loadScenario('bigLoss')

// 소액 투자자 케이스
mockUtils.loadScenario('smallPortfolio')

// 대규모 포트폴리오 케이스
mockUtils.loadScenario('largePortfolio')
```

#### 단계 3: UI 검증
- 자릿수별 폰트 사이즈 반응형 확인
- 수익/손실 색상 및 아이콘 표시 확인
- 카드 레이아웃 및 정렬 확인
- 반응형 디자인 동작 확인

#### 단계 4: 데이터 초기화
```javascript
// 모든 데이터 삭제 후 재시작
mockUtils.clear()
```

### 3.4 테스트 체크리스트

#### UI 반응성 테스트
- [ ] 1자리 금액 (0원) - 최대 폰트 사이즈 적용 확인
- [ ] 4자리 금액 (1,234원) - 큰 폰트 사이즈 확인
- [ ] 7자리 금액 (1,234,567원) - 중간 폰트 사이즈 확인
- [ ] 10자리 이상 (12,345,678,901원) - 작은 폰트 사이즈 확인

#### 수익/손실 케이스
- [ ] 큰 수익 (+100% 이상) - 색상 및 아이콘 확인
- [ ] 작은 수익 (+5% 미만) - 표시 정확도 확인
- [ ] 작은 손실 (-5% 미만) - 색상 변경 확인
- [ ] 큰 손실 (-30% 이상) - 경고 표시 확인

#### 포트폴리오 규모
- [ ] 소액 (100만원 미만) - 레이아웃 정렬 확인
- [ ] 중형 (1,000만원~5,000만원) - 카드 배치 확인
- [ ] 대형 (1억원 이상) - 스크롤 및 성능 확인

#### 데이터 밀도
- [ ] 메모가 많은 종목 - 리스트 렌더링 확인
- [ ] 첨부파일이 많은 메모 - 썸네일 표시 확인
- [ ] 계좌가 많은 사용자 - 드롭다운 동작 확인

### 3.5 개발 팁

#### 빠른 시나리오 전환
```javascript
// 여러 시나리오를 순차적으로 테스트
['bigProfit', 'bigLoss', 'smallPortfolio', 'largePortfolio'].forEach(scenario => {
  console.log(`Testing ${scenario}...`);
  mockUtils.loadScenario(scenario);
  // 각 시나리오에서 스크린샷 캡처 또는 검증 수행
});
```

#### 커스텀 데이터 생성
필요시 `src/lib/mockData.ts`의 `mockScenarios` 객체에 새로운 시나리오 추가 가능:
```typescript
export const mockScenarios = {
  // 기존 시나리오...
  
  customScenario: (): AppData => {
    // 커스텀 데이터 생성 로직
  }
};
```

### 3.6 주의사항

- 목 데이터는 **개발 환경에서만** 활성화됨 (`import.meta.env.DEV`)
- 프로덕션 빌드 시 MSW 및 목 데이터 관련 코드는 번들에 포함되지 않음
- localStorage 용량 제한(5~10MB)을 고려하여 대규모 시나리오 테스트 시 주의

---

## 4. 검증 및 배포 프로세스

### 4.1 기능 검증 (QA)
- 브라우저 에이전트를 활용한 시나리오 테스트 (예: 계좌 추가 -> 종목 추가 -> 이미지 첨부 -> 데이터 보존 확인).
- 다양한 화면 크기(반응형)에서의 레이아웃 깨짐 확인.

### 3.2 데이터 보존 가이드
- 스키마 변경 시 `initialData` 구조와 LocalStorage 키 버저닝(`stock_note_data_v1`) 관리.
- 배포 전 `pnpm build`를 통해 프로덕션 빌드 성공 여 확인.
