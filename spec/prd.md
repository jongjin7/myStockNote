# 주식 노트 웹앱 PRD (MVP v2.0)

## 1. 개요 (Overview)

본 문서는 개인 투자자가 여러 증권사에 분산된 주식 자산과 예수금을 **수동으로 기록·관리**하고, 종목별 투자 판단과 회고를 체계적으로 남길 수 있도록 돕는 **개인용 주식 노트 웹앱**의 MVP(Minimum Viable Product) 요구사항을 정의한다.

이 앱의 핵심 가치는 수익률이나 실시간 시세가 아니라, **투자 판단의 기록과 복기를 통해 더 나은 의사결정을 돕는 것**에 있다.

이 제품은 거래를 수행하는 시스템이 아니라, 투자 활동을 **정리·관리·복기**하기 위한 도구이며, 자동 계좌 연동이나 실시간 시세 제공은 범위에 포함하지 않는다.

---

## 2. 사용자 페르소나

* 역할: 주린이
* 투자 성향: 국내 주식(AI ETF, 반도체), 미국 주식(개별 종목, 배당주 중심의 성장주 중심)
* 계좌 현황: 한국투자증권, 유안타증권, 카카오증권 등 복수 증권사 이용
* 니즈:
  * 증권사별 자산을 한 화면에서 정리하고 싶음
  * 매수 이유와 투자 판단을 기록하고 싶음
  * 엑셀이나 메모앱보다 구조화된 관리 도구를 원함

### 사용 시나리오

* **사용 시점**: 평일 장 종료 후, 주말 자산 정리 시간, 매수 또는 매도 직후
* **주요 행동**:
  * 현재 포지션과 계좌별 자산 상태를 빠르게 확인
  * 방금 매수/매도한 종목에 대한 판단과 감정을 즉시 기록
  * 이전 투자 판단을 다시 읽으며 스스로의 결정을 복기
* **사용을 방해하는 요인**:
  * 입력 과정이 번거롭거나 시간이 많이 걸리는 경우
  * 단순 조회용 정보만 제공되어 기록할 이유가 없는 경우
  * HTS/MTS와 차별점이 느껴지지 않는 경우

---

## 3. 문제 정의 (Problem Statement)

* 증권사마다 앱/HTS가 분리되어 있어 전체 자산 상태를 직관적으로 파악하기 어려움
* 투자 판단(매수 이유, 기대, 실수)에 대한 기록이 흩어져 있거나 남아 있지 않음
* 시간이 지나면 왜 이 종목을 샀는지, 왜 팔았는지 스스로 설명하기 어려워짐

### 문제 정의 압축

> **개인 투자자는 언제든지 자신의 주식 종목을 관리하고 싶지만, 자산은 흩어져 있고 투자 판단은 기록되지 않아 스스로의 결정을 지속적으로 관리·복기하기 어렵다.**

---

## 4. 제품 목표 (Goals)

* 여러 증권사 계좌의 예수금과 보유 종목을 논리적으로 통합 관리
* 종목별 투자 판단과 히스토리를 기록할 수 있는 구조 제공
* 개인이 지속적으로 사용할 수 있는 단순하고 안정적인 웹앱 구현

---

## 5. 핵심 기능 (MVP Scope)

### 5.1 증권사 / 계좌 관리

* 증권사 이름을 기준으로 계좌를 생성 및 관리
* 계좌별 예수금을 직접 관리 (별도 테이블 없이 Account 내에서 관리)
* 증권사는 단순 구분용 메타 정보로 사용

**제약사항:**
- 계좌명 최대 길이: 50자
- 계좌 최대 개수: 20개
- 증권사명 중복 가능 (예: 한국투자증권 계좌 2개)

### 5.2 예수금 관리

**관리 정책:**
- 사용자가 수동으로 입력 (종목 매매와 연동하지 않음)
- 계좌별 예수금을 Account 테이블 내 cashBalance 필드로 관리
- 전체 예수금 자동 합산 표시
- 마지막 업데이트 시각 표시
- 히스토리는 MVP에서 제외, 현재 값만 관리

**입력 제약:**
- 예수금 범위: 0 ~ 999,999,999,999원
- 음수 불가

### 5.3 종목 관리

**종목 기본 정보 입력:**
- 종목명 (필수, 최대 50자)
- 종목 코드 (선택, 6자리)
- 보유 수량 (필수, 1 ~ 999,999)
- 평균 단가 (필수, 1 ~ 999,999,999원)
- 소속 계좌

**종목 상태 관리:**
- 보유 중 (HOLDING)
- 일부 매도 (PARTIAL_SOLD)
- 전량 매도 (SOLD)

**상태 전환 규칙:**
- 사용자가 수동으로 상태 변경 가능
- 자동 전환 없음 (수량이 0이 되어도 자동으로 SOLD로 변경되지 않음)
- 전량 매도 후 재매수 시: 새로운 종목으로 추가 (이전 기록 유지)

**중복 정책:**
- 동일 계좌 내 동일 종목코드 중복 등록 가능
- 사용자가 평균단가가 다른 매수를 별도로 관리하고 싶을 수 있음

※ 실시간 시세, 자동 수익률 계산은 MVP 범위에서 제외

### 5.4 종목별 투자 노트 (핵심 기능)

#### 기능 정의

종목별 투자 노트는 사용자의 투자 판단을 즉시 기록하고, 시간이 지난 뒤 다시 복기할 수 있도록 돕는 **이 앱의 핵심 기능**이다.

#### 노트 구조 (구조화된 필드 방식)

```
StockMemo
- id
- stockId
- type (PURCHASE: 매수, SELL: 매도, GENERAL: 일반)
- buyReason (매수 이유, 최대 500자)
- expectedScenario (기대 시나리오, 최대 500자)
- risks (리스크 요인, 최대 500자)
- currentThought (현재 판단, 최대 500자)
- sellReview (매도 회고, 최대 500자, optional)
- attachments (첨부 파일 배열, optional)
- createdAt
- updatedAt
```

**필드별 설명:**
- **매수 이유**: 왜 이 종목을 샀는가? (예: 실적 개선, 밸류에이션 매력)
- **기대 시나리오**: 어떤 일이 일어나길 기대하는가? (예: 목표가 50,000원)
- **리스크 요인**: 무엇이 잘못될 수 있는가? (예: 원자재 가격 상승)
- **현재 판단**: 지금 시점에서의 생각 (예: 추가 매수 고려 중)
- **매도 회고**: 매도 후 되돌아보기 (예: 손절이 옳았는지 판단)
- **첨부 파일**: 분석 자료, 캡쳐 이미지 등 (최대 5개)

#### 작성 트리거 (행동 단위)

사용자는 다음과 같은 시점에서 자연스럽게 노트를 작성한다:

- 종목을 신규로 추가했을 때 (매수 직후)
- 종목 상세 화면에 진입했을 때
- 대시보드에서 "노트가 없는 종목"을 클릭했을 때
- 매도 또는 상태 변경(보유 → 일부 매도 / 전량 매도) 직후

#### UX 원칙

- 노트 작성은 항상 **선택이 아닌 제안**의 형태로 노출된다
  - 예: "이 종목에 대한 판단을 남겨보세요" (CTA 버튼)
- 모든 필드가 선택 사항 (빈 노트도 저장 가능)
- 나중에 언제든 수정 가능
- 긴 글보다 짧은 문장 위주의 기록을 유도 (placeholder 활용)
- 이미지/텍스트 첨부 시 드래그 앤 드롭 지원

---

### 5.5 종목 리서치 자료 관리 (신규 기능)

#### 기능 정의

보유 중이거나 관심 있는 종목에 대해 ChatGPT, Claude 등 AI 서비스를 통해 얻은 분석 내용이나, 뉴스/공시 캡쳐 이미지를 첨부하여 투자 판단의 근거 자료로 활용할 수 있다.

#### 사용 시나리오

1. **AI 분석 결과 저장**
   - ChatGPT에 "삼성전자 2024년 실적 전망 분석해줘" 요청
   - 응답 내용을 복사하여 노트에 붙여넣기
   - 또는 응답 화면 캡쳐하여 이미지로 첨부

2. **뉴스/공시 캡쳐**
   - 증권사 리포트 캡쳐
   - 기업 공시 자료 스크린샷
   - 차트 분석 화면 저장

3. **정찰 종목 사전 조사**
   - 아직 매수하지 않은 종목도 "관심 종목"으로 등록
   - 리서치 자료를 미리 축적
   - 매수 시점 결정에 활용

#### 첨부 파일 관리

**지원 형식:**
- 이미지: JPG, PNG, WebP (최대 5MB/파일)
- 텍스트: 직접 입력 또는 복사/붙여넣기

**첨부 제약:**
- 노트당 최대 5개 첨부 파일
- 총 용량 제한: 25MB/노트 (LocalStorage 고려)
- 이미지는 자동으로 리사이징 (최대 가로 1920px)

**저장 방식:**
- LocalStorage 사용 시: Base64 인코딩하여 저장
- 향후 백엔드 연동 시: 파일 업로드 API 활용

**UI/UX:**
- 드래그 앤 드롭으로 이미지 첨부
- 붙여넣기(Ctrl+V)로 클립보드 이미지 첨부
- 썸네일 미리보기 제공
- 클릭 시 원본 크기로 확대 (라이트박스)
- 첨부 파일별 삭제 버튼

#### 데이터 모델 확장

```typescript
Attachment {
  id: string (UUID)
  memoId: string (FK → StockMemo.id)
  type: enum ('IMAGE' | 'TEXT')
  fileName: string (원본 파일명)
  fileSize: number (바이트)
  data: string (Base64 인코딩 또는 텍스트 내용)
  createdAt: timestamp
}
```

**StockMemo 관계:**
- StockMemo 1 : N Attachment

#### 관심 종목 (정찰 종목) 관리

기존 Stock 모델에 `watchlist` 상태 추가:

```typescript
Stock {
  ...
  status: enum ('WATCHLIST' | 'HOLDING' | 'PARTIAL_SOLD' | 'SOLD')
  ...
}
```

**상태별 의미:**
- **WATCHLIST**: 아직 매수하지 않았지만 관심 있는 종목
- **HOLDING**: 현재 보유 중
- **PARTIAL_SOLD**: 일부 매도
- **SOLD**: 전량 매도

**WATCHLIST 종목 특징:**
- 수량과 평균단가는 0 또는 null
- 계좌에 속하지 않음 (accountId: null 허용)
- 노트와 첨부 파일은 자유롭게 추가 가능
- 매수 시 HOLDING으로 상태 변경 + 수량/단가 입력

---

## 6. 대시보드

### 목적 정의

대시보드는 자산을 요약해서 보여주는 화면이 아니라, **사용자가 언제든지 자신의 주식 포지션을 빠르게 인식하고 다음 행동(관리·기록·회고)으로 이어지게 하는 진입 화면**이다.

### 제공 정보

* **전체 예수금 요약**
  - 모든 계좌의 예수금 합계
  - 마지막 업데이트 시각

* **계좌별 예수금 분포**
  - 증권사명, 예수금, 업데이트 시각
  - 계좌 클릭 시 해당 계좌의 종목 필터링

* **보유 종목 리스트 (상태 중심)**
  - 종목명, 수량, 평균단가, 상태
  - 노트 작성 여부 표시 (아이콘 또는 배지)
  - 종목 클릭 시 상세 화면 이동

* **최근 작성한 투자 노트 요약**
  - 최근 3개의 노트 미리보기
  - "더보기" 링크

### UX 원칙

* 숫자를 많이 보여주기보다 "지금 관리가 필요한 종목이 무엇인지"가 보이도록 설계
* 대시보드에서 바로 종목 상세 또는 투자 노트 작성으로 이동 가능
* 노트가 없는 종목을 시각적으로 강조 (예: 회색 배경, "노트 작성하기" 버튼)

※ 그래프/차트는 선택 사항이며, MVP에서는 표 중심 UI로 구현

---

## 7. 화면 구조 및 플로우

```
주요 화면 구조
├── 대시보드 (/)
│   ├── 전체 예수금
│   ├── 계좌별 요약
│   ├── 보유 종목 리스트 → [종목 상세 클릭]
│   └── 관심 종목 섹션 → [정찰 종목 보기]
│
├── 계좌 관리 (/accounts)
│   ├── 계좌 목록
│   ├── [계좌 추가] 버튼 → 계좌 추가 모달
│   └── [계좌 수정/삭제] → 계좌 편집 모달
│
├── 관심 종목 (/watchlist)
│   ├── 정찰 중인 종목 리스트
│   ├── [종목 추가] 버튼
│   └── 종목 클릭 → 종목 상세
│
├── 종목 상세 (/stocks/:id)
│   ├── 종목 정보 (종목명, 코드, 수량, 평균단가, 상태)
│   ├── [종목 정보 수정] 버튼
│   ├── 투자 노트 리스트 (시간순)
│   │   └── 각 노트의 첨부 파일 썸네일 표시
│   └── [노트 작성] 버튼 → 노트 작성 화면
│
├── 노트 작성/수정 (/stocks/:id/memos/new 또는 /memos/:memoId/edit)
│   ├── 노트 타입 선택 (매수/매도/일반)
│   ├── 구조화된 입력 필드
│   ├── 파일 첨부 영역 (드래그 앤 드롭)
│   │   ├── 이미지 업로드
│   │   └── 첨부된 파일 목록 (삭제 가능)
│   └── [저장] / [취소] 버튼
│
└── 이미지 뷰어 (모달)
    └── 첨부 이미지 확대 보기
```

**주요 사용자 플로우:**

1. **종목 추가 플로우**
   - 대시보드 → [종목 추가] → 종목 타입 선택 (보유/관심) → 종목 정보 입력 → 저장 → 종목 상세 → "노트 작성 제안" 표시

2. **노트 작성 플로우**
   - 종목 상세 → [노트 작성] → 필드 작성 → 이미지 드래그 앤 드롭 → 저장 → 종목 상세로 복귀

3. **회고 플로우**
   - 대시보드 → 종목 클릭 → 과거 노트 조회 → 첨부된 분석 자료 확인 → 현재 생각과 비교

4. **정찰 종목 → 매수 전환 플로우**
   - 관심 종목 → 종목 클릭 → [매수로 전환] 버튼 → 계좌/수량/단가 입력 → HOLDING으로 상태 변경

---

## 8. 데이터 모델 (상세)

### Account (계좌)
```typescript
{
  id: string (UUID)
  brokerName: string (증권사명, 최대 50자)
  cashBalance: number (예수금, 0 ~ 999,999,999,999)
  memo: string | null (메모, 최대 200자)
  createdAt: timestamp
  updatedAt: timestamp
}
```

### Stock (종목)
```typescript
{
  id: string (UUID)
  accountId: string | null (FK → Account.id, WATCHLIST인 경우 null 가능)
  symbol: string | null (종목코드, 6자리)
  name: string (종목명, 최대 50자)
  quantity: number (수량, 0 ~ 999,999, WATCHLIST인 경우 0)
  avgPrice: number (평균단가, 0 ~ 999,999,999, WATCHLIST인 경우 0)
  status: enum ('WATCHLIST' | 'HOLDING' | 'PARTIAL_SOLD' | 'SOLD')
  createdAt: timestamp
  updatedAt: timestamp
}
```

### StockMemo (투자 노트)
```typescript
{
  id: string (UUID)
  stockId: string (FK → Stock.id)
  type: enum ('PURCHASE' | 'SELL' | 'GENERAL')
  buyReason: string | null (최대 500자)
  expectedScenario: string | null (최대 500자)
  risks: string | null (최대 500자)
  currentThought: string | null (최대 500자)
  sellReview: string | null (최대 500자)
  createdAt: timestamp
  updatedAt: timestamp
}
```

### Attachment (첨부 파일)
```typescript
{
  id: string (UUID)
  memoId: string (FK → StockMemo.id)
  type: enum ('IMAGE' | 'TEXT')
  fileName: string (원본 파일명, 최대 255자)
  fileSize: number (바이트, 최대 5MB)
  mimeType: string (예: 'image/jpeg', 'image/png')
  data: string (Base64 인코딩된 이미지 또는 텍스트 내용)
  createdAt: timestamp
}
```

**관계:**
- Account 1 : N Stock
- Stock 1 : N StockMemo
- StockMemo 1 : N Attachment

---

## 9. 기술적 범위

### 플랫폼
- Web App (반응형 디자인, 모바일 최적화)

### 프론트엔드
- React
- TypeScript
- CSS Framework: Tailwind CSS V4.x

### 데이터 저장
- **초기 MVP**: LocalStorage 또는 IndexedDB
  - 장점: 백엔드 불필요, 빠른 개발
  - 단점: 브라우저별 용량 제한 (5~10MB), 기기 간 동기화 불가
  - **이미지 첨부 시 용량 관리 필수**: 
    - 이미지 자동 리사이징 (최대 가로 1920px)
    - WebP 형식으로 변환하여 용량 최적화
    - 용량 초과 시 경고 및 오래된 첨부 파일 삭제 제안
  - LocalStorage 용량 제한 시 처리: 경고 메시지 표시 후 오래된 데이터 삭제 제안

- **향후 확장**: 간단한 백엔드 연동 (Superbase)
  - 파일 스토리지 API 활용

### 에러 처리
- 필수 필드 누락 시 입력 폼에서 검증
- LocalStorage 용량 초과 시 경고 및 데이터 Export 유도
- 이미지 업로드 실패 시 재시도 옵션 제공
- 지원하지 않는 파일 형식 업로드 시 경고 메시지
- 파일 크기 초과 시 자동 리사이징 제안
- 네트워크 에러 (향후 백엔드 연동 시): Retry 로직 및 오프라인 모드

---

## 10. MVP에서 제외하는 기능

* 증권사 API 연동
* 실시간 주가/시세 제공
* 자동 수익률 계산
* 알림 기능 (Push Notification)
* 다중 사용자 지원
* 주문/매매 기능
* 차트/그래프 시각화 (선택적으로 Phase 2에서 추가 가능)
* 예수금 히스토리 관리
* OCR을 통한 이미지 텍스트 추출 (향후 검토)
* 첨부 파일 태그/카테고리 분류

---

## 11. 향후 확장 방향 (비구현)

* CSV/엑셀 Import (HTS 잔고 복사 → 붙여넣기)
* 월별 자산 스냅샷 저장
* 간단한 수익률 계산 기능 (평가금액 - 투자금액)
* 증권사 API 연동 가능성 검토
* 다크 모드 지원
* 태그 기능 (섹터별, 테마별 분류)
* 첨부 파일 검색 기능
* PDF 파일 첨부 지원
* OCR을 통한 공시/리포트 자동 텍스트 추출
* 첨부 이미지 내 텍스트 검색
* AI 분석 결과 직접 연동 (API 통합)

---

## 12. 데이터 백업 및 복구

### MVP 범위
* **Export 기능**
  - LocalStorage 전체 데이터를 JSON 파일로 다운로드
  - 파일명 형식: `stock-note-backup-YYYYMMDD.json`

* **Import 기능**
  - JSON 파일 업로드하여 데이터 복구
  - 기존 데이터 덮어쓰기 전 경고 메시지 표시
  - 데이터 유효성 검증 (스키마 체크)

### 목적
- 브라우저 캐시 삭제 또는 기기 변경 시 데이터 손실 방지
- 정기적인 백업 습관 유도 (UI에 "마지막 백업: N일 전" 표시)

---

## 13. 성공 기준 (MVP)

### 정량적 기준 (개인 사용 기준)
- ✅ 최소 3개 이상의 종목에 대해 투자 노트 작성
- ✅ 관심 종목 최소 2개 이상 등록 및 리서치 자료 첨부
- ✅ 노트에 이미지 첨부 최소 5회 이상
- ✅ 1주일에 최소 2회 이상 앱 접속 (2주 연속)
- ✅ 작성한 노트를 최소 1회 이상 다시 조회
- ✅ 종목 추가/수정/삭제가 정상 동작
- ✅ 데이터 Export/Import 1회 이상 성공

### 정성적 기준
- "이번 주말에 자산 정리하려면 이 앱을 켜야지"라는 생각이 듦
- 매도 후 "왜 샀었지?"라는 의문이 들 때 앱에서 답을 찾을 수 있음
- ChatGPT로 분석한 내용을 자연스럽게 앱에 저장하게 됨
- 관심 종목 분석 자료가 쌓여서 매수 시점 판단에 도움이 됨
- HTS보다 투자 판단 관리에 유용하다고 느낌

---

## 14. 개발 우선순위 및 일정

### Phase 1 (1주차) - 기본 구조
- [ ] 프로젝트 셋업 (React + TypeScript + Tailwind)
- [ ] 데이터 모델 설계 및 LocalStorage 유틸리티 구현
- [ ] 계좌 CRUD (추가/수정/삭제)
- [ ] 종목 CRUD (추가/수정/삭제)
- [ ] 기본 대시보드 (계좌 목록, 종목 목록)

### Phase 2 (2주차) - 핵심 기능
- [ ] 투자 노트 작성/수정/삭제
- [ ] 이미지 첨부 기능 구현 (드래그 앤 드롭, 붙여넣기)
- [ ] 이미지 자동 리사이징 및 WebP 변환
- [ ] 첨부 파일 썸네일 및 라이트박스 뷰어
- [ ] 관심 종목(WATCHLIST) 관리 기능
- [ ] 종목 상세 화면 (노트 리스트 포함)
- [ ] 예수금 입력 및 합산 표시
- [ ] 노트 작성 제안 UX 구현

### Phase 3 (3주차) - 완성도
- [ ] LocalStorage 용량 모니터링 및 경고 시스템
- [ ] UX 개선 (로딩 상태, 에러 메시지, 빈 상태 처리)
- [ ] 데이터 Export/Import 기능 (이미지 포함)
- [ ] 반응형 디자인 최적화
- [ ] 사용자 테스트 및 버그 수정
- [ ] 이미지 용량 최적화 검증

---

## 15. 제약사항 요약

| 항목 | 제약 |
|------|------|
| 계좌명 | 최대 50자 |
| 계좌 개수 | 최대 20개 |
| 종목명 | 최대 50자 |
| 종목코드 | 6자리 (선택) |
| 보유 수량 | 0 ~ 999,999 (WATCHLIST는 0) |
| 평균단가 | 0 ~ 999,999,999원 (WATCHLIST는 0) |
| 예수금 | 0 ~ 999,999,999,999원 |
| 노트 각 필드 | 최대 500자 |
| 계좌 메모 | 최대 200자 |
| 첨부 파일 개수 | 노트당 최대 5개 |
| 이미지 파일 크기 | 최대 5MB/파일 (자동 리사이징) |
| 노트 총 첨부 용량 | 최대 25MB/노트 |
| 지원 이미지 형식 | JPG, PNG, WebP |
| LocalStorage | 약 5~10MB (브라우저별 상이) |

---

## 16. 참고사항

* 이 문서는 MVP 개발을 위한 최소 요구사항을 정의하며, 개발 중 사용자 피드백에 따라 유연하게 조정될 수 있음
* 개발자 본인이 실제 사용자이므로, 개발 과정에서 발견되는 불편함을 즉시 개선할 것을 권장
* "완벽한 제품"보다 "계속 쓰고 싶은 제품"을 목표로 함
---

## 17. 프로세스 및 업무 상세 정의

상세한 입력 프로세스와 개발 워크플로우는 [프로세스 및 업무 상세 정의서](./workflow.md) 문서를 참조한다.
